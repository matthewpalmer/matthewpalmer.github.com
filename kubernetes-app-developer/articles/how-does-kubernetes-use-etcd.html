<html>
<head>
  <meta charset="utf-8">
  <title>How Does Kubernetes Use etcd?</title>
  <link rel="stylesheet" href="../styles.css" media="screen" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-35071535-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-35071535-2');
  </script>
</head>
<body class="sidebar">
    <nav class="article-nav">
        <a href="/kubernetes-app-developer/">🏡 Home</a>
        
        <a href="/kubernetes-app-developer/kubernetes-book.html">📖 Kubernetes Book</a>
        <a href="/kubernetes-app-developer/#purchase">🎓 CKAD Certification Course</a>
    </nav>
    
    <div class="article-container">
        <h1>How Does Kubernetes Use etcd?</h1>

        <p>Kubernetes uses etcd to store all its data – its configuration data,
        its state, and its metadata. Kubernetes is a distributed system,
        so it needs a distributed data store like etcd. etcd lets any of the nodes
        in the Kubernetes cluster read and write data.</p>

        <blockquote>I’ve also expanded on this article in <a href="http://qr.ae/TUGAh4">this Quora answer</a>.</blockquote>

        <h2>What is Kubernetes <em>really</em>?</h2>

        <p>Kubernetes is a set of processes running on several machines.</p>

        <p>(Actual, literal computer processes, not business-speak <em>processes</em>.)</p>

        <p>One of these machines is the <em>master</em> and the rest are the <em>worker</em> nodes.</p>

        <p><img src="etcd-diagram.png" alt="Diagram of Kubernetes cluster" /></p>

        <p>These processes have a range of responsibilities, including</p>

        <ul>
        <li>handling API requests from kubectl</li>
        <li>scheduling pods to run on worker nodes</li>
        <li>runninng a pod on the worker node</li>
        <li>monitoring and networking</li>
        </ul>

        <p>Like most of the code you’ve ever written… <strong>Kubernetes needs to store data somewhere</strong>.</p>

        <p>That’s what <strong>etcd</strong> is for!</p>

        <h2>What is etcd?</h2>

        <p>Now, we know that Kubernetes is distributed – it runs on several machines
        at the same time.</p>

        <p>So, it needs a distributed database. One that runs on several machines at the same time. One that makes it easy to store data
        across a cluster and watch for changes to that data.</p>

        <p><strong>Kubernetes uses etcd as its database.</strong></p>

        <p>The only nuance is that etcd is a distributed database – because Kubernetes is a distributed system.</p>

        <p>etcd manages a lot of the tricky problems in running a distributed database – like
        race conditions and networking – and saves Kubernetes from worrying about it.</p>

        <h2>How does Kubernetes use etcd?</h2>

        <p>Kubernetes uses etcd as a key-value database store. It stores the 
        configuration of the Kubernetes cluster in etcd. </p>

        <p>It also stores the <em>actual</em> state of the system and the <em>desired</em> state of the system
        in etcd. </p>

        <p>It then uses etcd’s <em>watch</em> functionality to monitor changes to either of these two things. If they diverge,
        Kubernetes makes changes to reconcile the actual state and the desired state.</p>

        <p><strong>A Kubernetes cluster stores all its data in etcd.</strong></p>

        <p>Anything you might read from a <code>kubectl get xyz</code> command is stored in etcd.</p>

        <p>Any change you make via <code>kubectl create</code> will cause an entry in etcd to be updated.</p>

        <p>Any node crashing or process dying causes values in etcd to be changed.</p>

        <p>The set of processes that make up Kubernetes use etcd to store data and
        notify each other of changes.</p>
    </div>

    <div class="sidebar-container">
      <a class="sidebar-cover" href="/kubernetes-app-developer/">
          <img class="cover" src="../ckad-guide-new.png" />
          <h2>Learn Kube Faster.<br/>Get the #1 guide.</h2>
      </a>
      
      <p>
          Get my book on Kubernetes for backend developers.
      </p>
      <p>
          Great for software engineers learning Kubernetes. Perfect
          for developers getting their CKAD certification.
      </p>
      <a class="sidebar-cta" href="/kubernetes-app-developer/">Get Book</a>
  </div>
    <div class="clear"></div>
</body>
</html>



